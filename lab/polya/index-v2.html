<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to Solve It ‚Äî Interactive Workshop v2</title>
<style>
:root{--bg:#0a0a0a;--surface:#141414;--surface2:#1e1e1e;--border:#2a2a2a;--text:#e8e4df;--dim:#8a8580;--accent:#d4a056;--accent2:#6ba3be;--green:#5cb85c;--red:#c44;--phase1:#d4a056;--phase2:#6ba3be;--phase3:#b07cc6;--phase4:#5cb85c;--font-d:Georgia,'Times New Roman',serif;--font-u:-apple-system,system-ui,sans-serif;--font-m:'Courier New',monospace}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:var(--font-d);font-size:18px;line-height:1.7;overflow-x:hidden}
a{color:var(--accent)}

/* Layout */
.container{max-width:900px;margin:0 auto;padding:0 20px}
section{padding:60px 0;border-bottom:1px solid var(--border)}
section:last-of-type{border-bottom:none}

/* Nav */
nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(10,10,10,.92);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:0 20px}
nav .inner{max-width:900px;margin:0 auto;display:flex;align-items:center;gap:8px;overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none;height:52px}
nav .inner::-webkit-scrollbar{display:none}
nav a{font-family:var(--font-u);font-size:13px;color:var(--dim);text-decoration:none;white-space:nowrap;padding:6px 10px;border-radius:6px;transition:all .2s}
nav a:hover,nav a.active{color:var(--accent);background:var(--surface)}
nav .brand{font-family:var(--font-d);font-size:16px;color:var(--text);font-weight:700;margin-right:12px;flex-shrink:0}

/* Typography */
h1{font-size:clamp(2rem,5vw,3.2rem);line-height:1.2;margin-bottom:12px}
h2{font-size:1.6rem;color:var(--accent);margin-bottom:20px;font-family:var(--font-d)}
h3{font-size:1.15rem;margin:20px 0 10px}
blockquote{border-left:3px solid var(--accent);padding:12px 20px;margin:20px 0;background:var(--surface);border-radius:0 8px 8px 0;font-style:italic;color:var(--dim)}

/* Components */
.box{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px;margin:16px 0}
.tag{display:inline-block;font-family:var(--font-m);font-size:12px;padding:2px 10px;border-radius:20px;background:var(--surface2);border:1px solid var(--border);color:var(--dim)}
.btn{font-family:var(--font-u);font-size:14px;min-height:44px;padding:10px 20px;border:1px solid var(--border);border-radius:8px;background:var(--surface2);color:var(--text);cursor:pointer;transition:all .2s;user-select:none;display:inline-flex;align-items:center;gap:6px}
.btn:hover{border-color:var(--accent);color:var(--accent)}
.btn:active{transform:scale(.97)}
.btn.active{background:var(--accent);color:var(--bg);border-color:var(--accent);font-weight:600}
.btn.sm{min-height:36px;padding:6px 14px;font-size:13px}
.btn-row{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
textarea,.input{font-family:var(--font-d);font-size:16px;width:100%;padding:12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);resize:vertical}
textarea:focus,.input:focus{outline:none;border-color:var(--accent)}
.tabs{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px}
.fade-in{animation:fadeIn .4s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:640px){.grid-2{grid-template-columns:1fr}}
.mono{font-family:var(--font-m);font-size:14px}
.dim{color:var(--dim)}
.accent{color:var(--accent)}
.hero{padding:100px 0 60px;text-align:center}
.hero p{max-width:560px;margin:0 auto;color:var(--dim)}

/* Coach bubble */
.coach{background:var(--surface);border:1px solid var(--accent);border-radius:16px 16px 16px 4px;padding:16px 20px;margin:12px 0;position:relative}
.coach::before{content:'üéì';position:absolute;top:-12px;left:-8px;font-size:20px}
.coach p{color:var(--dim);margin:4px 0;font-size:15px;font-family:var(--font-u)}
.coach p strong{color:var(--accent)}

/* Phase indicator */
.phase-bar{display:flex;gap:4px;margin:16px 0}
.phase-pip{flex:1;height:6px;border-radius:3px;background:var(--border);transition:background .3s}
.phase-pip.done{background:var(--green)}
.phase-pip.current{background:var(--accent);box-shadow:0 0 8px var(--accent)}

/* Canvas */
.draw-canvas{background:var(--surface);border:1px solid var(--border);border-radius:12px;cursor:crosshair;touch-action:none;display:block;width:100%;max-width:100%}

/* Analogy cards */
.analogy-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px;min-height:200px}
.analogy-card h4{font-family:var(--font-u);font-size:13px;text-transform:uppercase;letter-spacing:.08em;color:var(--accent2);margin-bottom:12px}
.mapping-line{display:flex;align-items:center;gap:8px;padding:8px 0;border-bottom:1px solid var(--border);font-size:15px;font-family:var(--font-u)}
.mapping-line:last-child{border-bottom:none}
.map-item{padding:6px 12px;border-radius:6px;cursor:pointer;transition:all .2s;border:1px solid var(--border);background:var(--surface2);font-size:14px}
.map-item:hover{border-color:var(--accent)}
.map-item.selected{border-color:var(--accent);background:rgba(212,160,86,.15);color:var(--accent)}
.map-item.matched{border-color:var(--green);background:rgba(92,184,92,.15);color:var(--green)}
.map-arrow{color:var(--dim)}

/* Slider */
.slider-wrap{margin:20px 0}
.slider-wrap input[type=range]{width:100%;accent-color:var(--accent);height:6px}
.slider-labels{display:flex;justify-content:space-between;font-family:var(--font-u);font-size:13px;color:var(--dim);margin-top:4px}
.spec-display{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px;margin:16px 0;min-height:120px;font-family:var(--font-m);font-size:15px;line-height:1.8}

/* Auxiliary canvas */
.aux-problem{position:relative}
.aux-hint{background:var(--surface);border:1px solid var(--green);border-radius:12px;padding:16px;margin:12px 0;display:none}
.aux-hint.show{display:block}

/* Reflector */
.reflect-q{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px;margin:8px 0;cursor:pointer;transition:all .2s}
.reflect-q:hover{border-color:var(--accent)}
.reflect-q .answer{display:none;margin-top:12px;padding-top:12px;border-top:1px solid var(--border);color:var(--dim);font-size:15px}
.reflect-q.open .answer{display:block}
</style>
</head>
<body>

<nav>
<div class="inner">
<a href="../" class="brand">P√≥lya v2</a>
<a href="#workshop">Workshop</a>
<a href="#toolkit">Toolkit</a>
<a href="#coach">Coach</a>
<a href="#analogy">Analogy</a>
<a href="#specgen">Spec/Gen</a>
<a href="#lookback">Look Back</a>
<a href="#auxiliary">Auxiliary</a>
</div>
</nav>

<div class="container">

<!-- HERO -->
<div class="hero" id="top">
<h1>How to Solve It</h1>
<p style="font-style:italic;color:var(--dim);font-size:1.1rem;margin-bottom:16px">George P√≥lya, 1945</p>
<p>Not a book report. A workshop. Pick a problem, apply the heuristics, learn by doing ‚Äî the way P√≥lya intended.</p>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 1. PROBLEM-SOLVING WORKSHOP            -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="workshop">
<h2>1. Problem-Solving Workshop</h2>
<p>Work through a real problem using P√≥lya's four phases. The interface guides ‚Äî it doesn't give answers. Write your thinking at each step before revealing hints.</p>

<div class="tabs" id="ws-tabs"></div>
<div id="ws-body"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 2. HEURISTIC TOOLKIT                   -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="toolkit">
<h2>2. Heuristic Toolkit</h2>
<p>Each heuristic is a <em>tool</em> you apply when stuck. Not a list to memorize ‚Äî a set of actions to perform.</p>

<div id="tk-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:10px;margin:20px 0"></div>
<div id="tk-workspace"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 3. QUESTIONING COACH                   -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="coach">
<h2>3. The Questioning Coach</h2>
<p>P√≥lya's genius was asking the right question at the right moment. Select a problem, then work through it with a Socratic coach who asks ‚Äî never tells.</p>

<div class="tabs" id="coach-tabs"></div>
<div id="coach-body"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 4. ANALOGY FINDER                      -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="analogy">
<h2>4. Analogy Finder</h2>
<p>Two problems side by side. One solved, one not. Map the structural correspondence ‚Äî see how solving one illuminates the other.</p>

<div class="tabs" id="an-tabs"></div>
<div id="an-body"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 5. SPECIALIZATION / GENERALIZATION LAB -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="specgen">
<h2>5. Specialization / Generalization Lab</h2>
<p>Drag the slider from specific to general. Watch how extreme cases reveal the pattern ‚Äî the Inventor's Paradox in action.</p>

<div class="tabs" id="sg-tabs"></div>
<div id="sg-body"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 6. LOOK BACK REFLECTOR                 -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="lookback">
<h2>6. Look Back Reflector</h2>
<p>The most skipped, most valuable phase. After solving, the interface asks questions that turn one solution into a tool for many.</p>

<div class="tabs" id="lb-tabs"></div>
<div id="lb-body"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- 7. AUXILIARY ELEMENTS                  -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="auxiliary">
<h2>7. Auxiliary Elements</h2>
<p>Geometric problems where you must <strong>add a construction line</strong> to see the solution. Draw on the canvas ‚Äî discover the hidden structure.</p>

<div class="tabs" id="aux-tabs"></div>
<div id="aux-body"></div>
</section>

<footer style="text-align:center;padding:60px 0;color:var(--dim);font-family:var(--font-u);font-size:14px">
<p>Built by üêë ¬∑ February 2026 ¬∑ <a href="index.html" style="color:var(--dim)">v1</a> ¬∑ <a href="../" style="color:var(--dim)">Back to Lab</a></p>
</footer>

</div><!-- .container -->

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const PROBLEMS=[
{id:"diagonal",title:"Room Diagonal",domain:"Geometry",
 statement:"A rectangular room has length a, width b, height c. Find the diagonal from one floor corner to the opposite ceiling corner.",
 phases:[
  {questions:["What exactly are you asked to find?","What data do you have?","Can you visualize this? Where does the diagonal go?"],
   coachQs:["What is the unknown?","What are the data?","Is there a figure you can draw?","Is the condition sufficient to determine the unknown?"],
   hints:["The unknown is a length ‚Äî the straight-line distance between two opposite corners of a 3D box.","Three dimensions fully determine the box, so three numbers should determine the diagonal."]},
  {questions:["Do you know a related problem?","What theorem gives you lengths from other lengths?","Can you introduce a right triangle?"],
   coachQs:["Do you know a related problem?","Look at the unknown ‚Äî it's a length. What gives lengths?","Could you use the Pythagorean theorem? Where's the right triangle?","Can you solve part of the problem first?"],
   hints:["The 2D diagonal of a rectangle uses the Pythagorean theorem ‚Äî that's your related problem!","Apply Pythagoras twice: floor diagonal ‚àö(a¬≤+b¬≤), then room diagonal ‚àö(floor¬≤+c¬≤)."]},
  {questions:["Carry out your plan step by step.","Floor diagonal: y = ‚àö(a¬≤+b¬≤)","Room diagonal: x = ‚àö(y¬≤+c¬≤) = ‚àö(a¬≤+b¬≤+c¬≤)"],
   coachQs:["Can you carry out the plan?","Check each step ‚Äî is it correct?","Can you verify with numbers, say a=12, b=4, c=3?"],
   hints:["With (12,4,3): y¬≤=160, x¬≤=169, x=13. ‚úì","Each step uses Pythagoras on a genuine right triangle."]},
  {questions:["Does the formula make sense for special cases?","What if c=0? What if a=b=c?","Can you use this result elsewhere?"],
   coachQs:["Can you check the result?","Can you derive it differently?","Can you use the result for some other problem?"],
   hints:["If c=0 ‚Üí ‚àö(a¬≤+b¬≤), the 2D theorem. If a=b=c ‚Üí a‚àö3, the cube diagonal.","The formula is symmetric in a,b,c ‚Äî makes sense. Generalizes to n dimensions: ‚àö(x‚ÇÅ¬≤+...+x‚Çô¬≤)."]}
 ]},
{id:"checkerboard",title:"Mutilated Checkerboard",domain:"Logic",
 statement:"An 8√ó8 checkerboard has two diagonally opposite corners removed. Can you tile the remaining 62 squares with 31 dominoes (each covering 2 adjacent squares)?",
 phases:[
  {questions:["What type of answer is the unknown? (Not a number!)","What are the constraints?","What do the removed corners look like on a real board?"],
   coachQs:["What is the unknown?","Is it a number? A construction? Or a yes/no?","What are the data ‚Äî what exactly is given?","Can you visualize the board?"],
   hints:["This is a yes/no question. Often solved by proving impossibility.","Diagonally opposite corners on a checkerboard are the SAME color."]},
  {questions:["Why do direct attempts at tiling fail?","Think about coloring. How many black vs white squares remain?","What does each domino cover in terms of colors?"],
   coachQs:["Have you tried constructing a tiling?","What property does every domino have regarding colors?","How many black and white squares are there?","Do the numbers work out?"],
   hints:["Each domino covers exactly 1 black + 1 white square.","We removed 2 same-colored squares ‚Üí 30 of one color, 32 of the other. But 31 dominoes need 31+31!"]},
  {questions:["Write the proof clearly.","Each domino covers 1 black + 1 white. 31 dominoes need 31 of each. But we have 30+32. Contradiction."],
   coachQs:["Can you state the argument precisely?","Is every step justified?"],
   hints:["Suppose a tiling exists ‚Üí 31 dominoes ‚Üí 31 black, 31 white needed ‚Üí but we have 30+32 ‚Üí contradiction. ‚àé"]},
  {questions:["What general technique did you use?","Where else might 'invariants' be useful?"],
   coachQs:["What made this hard at first?","What made it easy once you saw the trick?","What's the general method?","Can you use it on other problems?"],
   hints:["We used an INVARIANT ‚Äî color balance ‚Äî that any valid tiling must preserve.","This technique works for many impossibility proofs: find a preserved quantity, show the goal state violates it."]}
 ]},
{id:"jugs",title:"Water Jugs (4 Liters)",domain:"Working Backwards",
 statement:"You have a 5-liter jug and a 3-liter jug, neither with markings. Measure exactly 4 liters from a river.",
 phases:[
  {questions:["What does 'measure 4 liters' mean concretely?","What operations can you perform?","Is this even possible?"],
   coachQs:["What is the unknown?","It's not a number ‚Äî what type of thing?","What are the allowed operations?","Is the data sufficient?"],
   hints:["The unknown is a sequence of operations leaving exactly 4L in the 5-jug.","Operations: fill completely, empty completely, pour from one to other (stop when source empty or target full)."]},
  {questions:["Try working backwards: if the 5-jug has 4L, what just happened?","4 = 5 - 1. Can you measure 1 liter?","Or try mapping all reachable states."],
   coachQs:["What would give you 4?","Can you work backwards from the goal?","4 = 5 - 1. How would you get 1 liter?","Do you know a simpler related problem?"],
   hints:["Working backwards: 4L in 5-jug means we poured 1L out. So the 3-jug had 2L free space (contained 1L).","Get 1L: fill 3‚Üípour into 5, fill 3‚Üípour into 5 (takes only 2 more), leaves 1L in 3-jug."]},
  {questions:["Track both jugs at every step.","(5-jug, 3-jug): (0,0)‚Üí(5,0)‚Üí(2,3)‚Üí(2,0)‚Üí(0,2)‚Üí(5,2)‚Üí(4,3) ‚úì"],
   coachQs:["Can you execute step by step?","What state are you in after each pour?"],
   hints:["6 operations: fill 5‚Üípour to 3‚Üíempty 3‚Üípour 5 to 3‚Üífill 5‚Üípour to 3. Result: (4,3). ‚úì"]},
  {questions:["Is there a shorter solution?","What other volumes can you measure?","What's the general principle?"],
   coachQs:["Can you check the result?","Is there another way?","What can you measure in general with jugs a and b?"],
   hints:["With gcd(a,b)=1, you can measure ANY integer 1..max(a,b). This is B√©zout's identity!","Working backwards: 'The dog goes around the fence; the hen cannot.'"]}
 ]},
{id:"handshake",title:"Handshake Problem",domain:"Combinatorics",
 statement:"At a party of 20 people, everyone shakes hands with everyone else exactly once. How many handshakes?",
 phases:[
  {questions:["What type of quantity is the unknown?","Can you try simpler cases first?","2 people: ? handshakes. 3 people: ? 4 people: ?"],
   coachQs:["What is the unknown?","What are the data?","Can you solve a simpler version first?","Try n=2, n=3, n=4."],
   hints:["We're counting unordered pairs of people.","2‚Üí1, 3‚Üí3, 4‚Üí6. See a pattern?"]},
  {questions:["Each person shakes hands with how many others?","If you sum all those, did you count each handshake once or twice?","Find a formula."],
   coachQs:["How many handshakes does one person do?","If everyone reports their handshakes, what's the total?","Is there overcounting?","Can you find a formula for n people?"],
   hints:["20 people √ó 19 handshakes each = 380. But each handshake was counted twice ‚Üí 380/2 = 190.","General: n(n-1)/2 = C(n,2)."]},
  {questions:["Compute: 20 √ó 19 / 2 = 190."],
   coachQs:["Carry out the computation.","Is it correct?"],
   hints:["190 handshakes."]},
  {questions:["Verify with small cases: n(n-1)/2 for n=2,3,4 gives 1,3,6. ‚úì","Where else does this formula appear?"],
   coachQs:["Can you check with your earlier small cases?","Where else is this formula?","Can you use it for other problems?"],
   hints:["Triangular numbers! Also: edges in complete graph, round-robin tournament games, entries in upper-triangular matrix.","The Inventor's Paradox: solving for general n was easier than solving for 20."]}
 ]}
];

const HEURISTICS=[
{icon:"‚úèÔ∏è",name:"Draw a Figure",desc:"Visualization makes hidden structure visible.",
 action:"canvas",
 prompt:"Draw the problem. Sketch the room, the board, the jugs ‚Äî whatever helps you see.",
 detail:"P√≥lya: nearly every problem benefits from a figure. Even non-geometric problems can be diagrammed. The act of drawing forces you to understand what you're working with."},
{icon:"üîó",name:"Find Related Problem",desc:"What problem with the same unknown have you solved before?",
 action:"related",
 prompt:"The unknown is a ___. What familiar problem has the same type of unknown?",
 detail:"Look at the unknown! If it's a length ‚Üí Pythagorean theorem. A count ‚Üí combinations. A yes/no ‚Üí invariants. Narrow your search from 'all of math' to 'problems with this unknown type.'"},
{icon:"‚è™",name:"Work Backwards",desc:"Start from the goal and ask: what would give me this?",
 action:"backwards",
 prompt:"Write the goal state. Now: what operation or fact would produce this goal?",
 detail:"'There is a certain psychological repugnance to this reverse order.' But it's enormously powerful. The dog goes around the fence; the hen cannot."},
{icon:"üî¨",name:"Specialize",desc:"Try specific values, boundary cases, extreme cases.",
 action:"specialize",
 prompt:"Try n=1. Try n=2. What happens at the boundary? What's the simplest case?",
 detail:"When the general statement feels too abstract, ground it in specifics. Test edges of the domain. If a formula works for all n, it must work for n=1."},
{icon:"üî≠",name:"Generalize",desc:"Replace specific values with variables. See the structure.",
 action:"generalize",
 prompt:"Replace 20 with n. Replace 8√ó8 with n√ón. What pattern emerges?",
 detail:"The Inventor's Paradox: the more general problem may be EASIER because the structure becomes visible. Solving for n reveals what solving for 20 hides."},
{icon:"‚úÇÔ∏è",name:"Decompose",desc:"Break the problem into independent sub-problems.",
 action:"decompose",
 prompt:"Can you split this into two simpler problems? What are the parts?",
 detail:"The room diagonal decomposes into two Pythagorean problems. Complex ‚Üí manageable when you find the seams."},
{icon:"üìñ",name:"Use Definitions",desc:"Go back to the definition. Eliminate technical terms.",
 action:"definition",
 prompt:"What does each technical term in the problem actually MEAN?",
 detail:"P√≥lya: 'Go back to definitions.' The parabola problem transforms from intimidating to tractable when you replace 'parabola' with its definition."},
{icon:"üåâ",name:"Auxiliary Problem",desc:"Solve a stepping-stone problem that gets you closer.",
 action:"auxiliary",
 prompt:"What simpler problem, if solved, would help with this one?",
 detail:"An insect rams the window repeatedly. A human finds the open door. Introduce a stepping stone ‚Äî an auxiliary problem whose solution illuminates yours."}
];

const ANALOGIES=[
{title:"Triangle ‚Üí Tetrahedron",
 solved:{name:"Center of gravity of a triangle",steps:["3 vertices","3 medians (vertex to midpoint of opposite side)","Medians meet at centroid","Centroid = (A+B+C)/3","Divides each median 2:1"]},
 unsolved:{name:"Center of gravity of a tetrahedron",steps:["4 vertices","? medians (vertex to centroid of opposite face)","Do they meet at one point?","Centroid = (A+B+C+D)/4?","Divides each median 3:1?"]},
 mappings:[["3 vertices","4 vertices"],["median to midpoint","median to face centroid"],["3 medians meet","4 medians meet (prove!)"],["average of 3","average of 4"],["ratio 2:1","ratio 3:1"]],
 insight:"The analogy is structural: everything that works in 2D has a 3D counterpart. The METHOD transfers: average the vertices. 'Analogy pervades all our thinking.'"},
{title:"2D Diagonal ‚Üí 3D Diagonal",
 solved:{name:"Diagonal of a rectangle (2D)",steps:["Two sides: a, b","One right triangle","Pythagorean theorem","d = ‚àö(a¬≤ + b¬≤)","One application of Pythagoras"]},
 unsolved:{name:"Diagonal of a box (3D)",steps:["Three sides: a, b, c","Two right triangles?","Pythagoras twice?","d = ‚àö(a¬≤ + b¬≤ + c¬≤)?","Generalize to nD?"]},
 mappings:[["2 dimensions","3 dimensions"],["1 right triangle","2 right triangles"],["1 application","2 applications"],["‚àö(a¬≤+b¬≤)","‚àö(a¬≤+b¬≤+c¬≤)"],["rectangle","rectangular box"]],
 insight:"The 3D problem reduces to the 2D problem applied twice. The pattern suggests the n-dimensional distance formula."},
{title:"Sum of integers ‚Üí Sum of cubes",
 solved:{name:"Sum 1+2+...+n",steps:["Pair terms: 1+n, 2+(n-1), ...","n/2 pairs, each summing to n+1","Formula: n(n+1)/2","These are triangular numbers T(n)","T(n) grows as n¬≤/2"]},
 unsolved:{name:"Sum 1¬≥+2¬≥+...+n¬≥",steps:["Compute small cases: 1,9,36,100,225","These are perfect squares!","Squares of what? 1,3,6,10,15","Those are triangular numbers!","Formula: [n(n+1)/2]¬≤ = T(n)¬≤"]},
 mappings:[["sum of k","sum of k¬≥"],["linear pairing trick","tabulate and observe"],["n(n+1)/2","[n(n+1)/2]¬≤"],["triangular numbers","squares of triangulars"],["direct formula","discovered by induction"]],
 insight:"The sum of cubes equals the square of the sum. Discovered by observing specific cases ‚Äî generalization revealed what no single case could."}
];

const SPECGEN_PROBLEMS=[
{title:"Handshakes at a party",
 variable:"n",
 cases:[
  {n:"n = 2",val:"2 people ‚Üí 1 handshake",formula:"1"},
  {n:"n = 3",val:"3 people ‚Üí 3 handshakes (AB, AC, BC)",formula:"3"},
  {n:"n = 4",val:"4 people ‚Üí 6 handshakes",formula:"6"},
  {n:"n = 5",val:"5 people ‚Üí 10 handshakes",formula:"10"},
  {n:"n = 10",val:"10 people ‚Üí 45 handshakes",formula:"45"},
  {n:"n = 20",val:"20 people ‚Üí 190 handshakes",formula:"190"},
  {n:"n = 100",val:"100 people ‚Üí 4950 handshakes",formula:"4950"},
  {n:"General",val:"n people ‚Üí n(n‚àí1)/2 handshakes",formula:"n(n‚àí1)/2"}
 ],
 insight:"The pattern 1, 3, 6, 10... = triangular numbers becomes obvious when you tabulate. The specific case n=20 hides the structure; the general case reveals it."},
{title:"Sum of first n cubes",
 variable:"n",
 cases:[
  {n:"n = 1",val:"1¬≥ = 1 = 1¬≤",formula:"1¬≤"},
  {n:"n = 2",val:"1¬≥+2¬≥ = 9 = 3¬≤",formula:"3¬≤"},
  {n:"n = 3",val:"1¬≥+2¬≥+3¬≥ = 36 = 6¬≤",formula:"6¬≤"},
  {n:"n = 4",val:"1¬≥+2¬≥+3¬≥+4¬≥ = 100 = 10¬≤",formula:"10¬≤"},
  {n:"n = 5",val:"1¬≥+...+5¬≥ = 225 = 15¬≤",formula:"15¬≤"},
  {n:"n = 6",val:"1¬≥+...+6¬≥ = 441 = 21¬≤",formula:"21¬≤"},
  {n:"n = 10",val:"1¬≥+...+10¬≥ = 3025 = 55¬≤",formula:"55¬≤"},
  {n:"General",val:"1,3,6,10,15,21,55 = T(n) ‚Üí Sum = [T(n)]¬≤ = [n(n+1)/2]¬≤",formula:"[n(n+1)/2]¬≤"}
 ],
 insight:"One case gives you a number. Several cases give you a PATTERN. The squares 1,9,36,100 are squares of triangular numbers. Generalization made the problem easier."},
{title:"Diagonal of an n-dimensional box",
 variable:"dimensions",
 cases:[
  {n:"1D",val:"Line segment of length a ‚Üí diagonal = a",formula:"a"},
  {n:"2D",val:"Rectangle a√ób ‚Üí diagonal = ‚àö(a¬≤+b¬≤)",formula:"‚àö(a¬≤+b¬≤)"},
  {n:"3D",val:"Box a√ób√óc ‚Üí diagonal = ‚àö(a¬≤+b¬≤+c¬≤)",formula:"‚àö(a¬≤+b¬≤+c¬≤)"},
  {n:"4D",val:"Hyperbox ‚Üí diagonal = ‚àö(a¬≤+b¬≤+c¬≤+d¬≤)",formula:"‚àö(a¬≤+b¬≤+c¬≤+d¬≤)"},
  {n:"nD",val:"n-dimensional box ‚Üí ‚àö(a‚ÇÅ¬≤+a‚ÇÇ¬≤+...+a‚Çô¬≤)",formula:"‚àö(Œ£a·µ¢¬≤)"},
  {n:"Unit cube nD",val:"All sides=1 ‚Üí diagonal = ‚àön",formula:"‚àön"},
  {n:"n‚Üí‚àû",val:"Unit hypercube diagonal ‚Üí ‚àû (!)",formula:"‚Üí ‚àû"},
  {n:"General",val:"Distance formula in Euclidean n-space: d = ‚àö(Œ£(x·µ¢‚àíy·µ¢)¬≤)",formula:"Euclidean distance"}
 ],
 insight:"Each dimension adds one more squared term under the radical. The pattern is unmistakable once you line up the cases. Special cases (unit cube: ‚àön) give surprising insights (diagonal grows without bound!)."}
];

const LOOKBACK_PROBLEMS=[
{title:"Room Diagonal: ‚àö(a¬≤+b¬≤+c¬≤)",
 questions:[
  {q:"Can you check the result with special cases?",a:"If c=0 ‚Üí ‚àö(a¬≤+b¬≤), the 2D Pythagorean theorem. If a=b=c ‚Üí a‚àö3, the space diagonal of a cube. Both check out."},
  {q:"Can you derive the result differently?",a:"Use the distance formula directly: d = ‚àö((a-0)¬≤+(b-0)¬≤+(c-0)¬≤) = ‚àö(a¬≤+b¬≤+c¬≤). Same answer, different path."},
  {q:"Is the formula symmetric? Should it be?",a:"Yes ‚Äî symmetric in a,b,c. A box doesn't care which dimension you call 'length.' The symmetry of the formula matches the symmetry of the object."},
  {q:"Can you use this result for another problem?",a:"Distance between any two points in 3D. Length of a vector. Generalizes to n dimensions. The method (apply Pythagoras iteratively) is the real tool."},
  {q:"Can you see it at a glance now?",a:"Each dimension contributes its square under the radical. The pattern is additive and self-similar: solving nD = solving (n-1)D + one more application."}
 ]},
{title:"Checkerboard: Impossible (coloring invariant)",
 questions:[
  {q:"What made this problem hard at first?",a:"The temptation to try constructing a tiling. You could search forever. The difficulty was recognizing that the answer is 'no.'"},
  {q:"Can you derive the result differently?",a:"Parity argument: dominoes always cover even numbers of squares in each row, but the mutilated board has odd counts in corner rows. (Harder to formalize, but works.)"},
  {q:"What general technique did you discover?",a:"INVARIANTS. Find a quantity preserved by all legal moves. If the goal state has a different value of this invariant, it's unreachable. Immensely powerful."},
  {q:"Where else can you use this technique?",a:"Any impossibility proof. Can you reach state X by applying operations Y? Check: is there an invariant that distinguishes X from your start? Used in: Rubik's cube parity, 15-puzzle, conservation laws in physics."},
  {q:"What if we removed two squares of different colors instead?",a:"Then it's always possible to tile! (This is a known theorem.) The coloring argument told us exactly what matters."}
 ]},
{title:"Water Jugs: (5,0)‚Üí...‚Üí(4,3)",
 questions:[
  {q:"Can you check: does each step use a legal operation?",a:"(0,0)‚Üífill 5‚Üí(5,0)‚Üípour to 3‚Üí(2,3)‚Üíempty 3‚Üí(2,0)‚Üípour to 3‚Üí(0,2)‚Üífill 5‚Üí(5,2)‚Üípour to 3‚Üí(4,3). Six legal operations. ‚úì"},
  {q:"Is there a shorter solution?",a:"Alternate path: (0,0)‚Üí(0,3)‚Üí(3,0)‚Üí(3,3)‚Üí(5,1)‚Üí(0,1)‚Üí(1,0)‚Üí(1,3)‚Üí(4,0). Same length, different route. No shorter solution exists."},
  {q:"What other volumes can you measure with 5 and 3?",a:"Since gcd(5,3)=1, you can measure ANY integer 1 through 5. Try it: 1L, 2L, 3L are all reachable."},
  {q:"What's the connection to number theory?",a:"B√©zout's identity: since gcd(a,b)=1, there exist integers x,y with ax+by=1. The jug operations implement the Extended Euclidean Algorithm!"},
  {q:"What strategy found the solution?",a:"Working backwards: goal (4,_) ‚Üí what produces 4 in the 5-jug? ‚Üí subtract 1 ‚Üí how to get 1? This 'reverse engineering' is one of P√≥lya's most powerful heuristics."}
 ]}
];

const AUX_PROBLEMS=[
{title:"Triangle Area Bisector",
 desc:"Given triangle ABC, find a line through vertex A that divides the triangle into two equal areas.",
 canvasSetup:function(ctx,w,h){
  const ax=w*.5,ay=h*.12,bx=w*.12,by=h*.85,cx=w*.88,cy=h*.85;
  ctx.strokeStyle='#6ba3be';ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(ax,ay);ctx.lineTo(bx,by);ctx.lineTo(cx,cy);ctx.closePath();ctx.stroke();
  ctx.fillStyle='#e8e4df';ctx.font='16px sans-serif';
  ctx.fillText('A',ax-4,ay-10);ctx.fillText('B',bx-16,by+6);ctx.fillText('C',cx+6,cy+6);
  return {ax,ay,bx,by,cx,cy};
 },
 hints:["What auxiliary element could you add? Think: what line through A gives equal areas?","Two triangles sharing the same height have areas proportional to their bases.","Draw the MEDIAN from A to the midpoint M of BC. Both triangles ABM and ACM share height from A and have equal bases BM=MC."],
 solution:"The median from A to the midpoint of BC. Since both sub-triangles share the same height (from A to BC) and have equal bases (BM = MC), they have equal areas."},
{title:"Inscribed Angle",
 desc:"Prove that an inscribed angle is half the central angle subtending the same arc. Hint: draw an auxiliary line.",
 canvasSetup:function(ctx,w,h){
  const cx=w*.5,cy=h*.5,r=Math.min(w,h)*.38;
  ctx.strokeStyle='#6ba3be';ctx.lineWidth=2;
  ctx.beginPath();ctx.arc(cx,cy,r,0,Math.PI*2);ctx.stroke();
  // Points on circle
  const a=-.8,b=.6,p=-2.2;
  const ax2=cx+r*Math.cos(a),ay2=cy+r*Math.sin(a);
  const bx=cx+r*Math.cos(b),by=cy+r*Math.sin(b);
  const px=cx+r*Math.cos(p),py=cy+r*Math.sin(p);
  // Central angle
  ctx.strokeStyle='#d4a056';ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(ax2,ay2);ctx.stroke();
  ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(bx,by);ctx.stroke();
  // Inscribed angle
  ctx.strokeStyle='#b07cc6';ctx.beginPath();ctx.moveTo(px,py);ctx.lineTo(ax2,ay2);ctx.stroke();
  ctx.beginPath();ctx.moveTo(px,py);ctx.lineTo(bx,by);ctx.stroke();
  ctx.fillStyle='#e8e4df';ctx.font='16px sans-serif';
  ctx.fillText('A',ax2+8,ay2);ctx.fillText('B',bx+8,by);ctx.fillText('P',px-20,py);ctx.fillText('O',cx+6,cy-8);
  ctx.fillStyle='#d4a056';ctx.font='13px sans-serif';ctx.fillText('central',cx-10,cy+20);
  ctx.fillStyle='#b07cc6';ctx.fillText('inscribed',px-10,py+20);
 },
 hints:["Draw the diameter from P through O. This splits the inscribed angle into two parts.","Each part creates an isosceles triangle (two sides are radii).","In each isosceles triangle, the exterior angle = 2√ó base angle. Sum the parts: inscribed angle = ¬Ω central angle."],
 solution:"Draw diameter through P and O. This creates two isosceles triangles (OP is radius to each). The exterior angle of each isosceles triangle equals twice the base angle. The central angle is the sum of the two exterior angles; the inscribed angle is the sum of the two base angles. Therefore inscribed = ¬Ω central."},
{title:"Pythagorean Theorem (Proof by Altitude)",
 desc:"In a right triangle with hypotenuse c, drop the altitude from the right angle to the hypotenuse. Prove a¬≤ + b¬≤ = c¬≤.",
 canvasSetup:function(ctx,w,h){
  const ax=w*.15,ay=h*.8,bx=w*.85,by=h*.8,cx2=w*.35,cy2=h*.2;
  ctx.strokeStyle='#6ba3be';ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(ax,ay);ctx.lineTo(bx,by);ctx.lineTo(cx2,cy2);ctx.closePath();ctx.stroke();
  // Right angle mark at C
  ctx.strokeStyle='#5cb85c';ctx.lineWidth=1;
  ctx.strokeRect(cx2,cy2,12,12);
  ctx.fillStyle='#e8e4df';ctx.font='16px sans-serif';
  ctx.fillText('A',ax-6,ay+20);ctx.fillText('B',bx+4,by+20);ctx.fillText('C',cx2-6,cy2-10);
  ctx.fillStyle='#dim';ctx.font='14px sans-serif';
  ctx.fillText('a',((cx2+bx)/2)+8,(cy2+by)/2);ctx.fillText('b',((ax+cx2)/2)-14,(ay+cy2)/2);ctx.fillText('c',(ax+bx)/2,ay+20);
 },
 hints:["Drop the altitude from C to AB. Call the foot H. This is the auxiliary element.","The altitude creates TWO smaller triangles, both similar to the original.","‚ñ≥ACH ~ ‚ñ≥ABC gives b¬≤=c¬∑AH. ‚ñ≥BCH ~ ‚ñ≥ABC gives a¬≤=c¬∑BH. Add: a¬≤+b¬≤=c¬∑(AH+BH)=c¬∑c=c¬≤."],
 solution:"Drop altitude CH to hypotenuse. ‚ñ≥ACH ~ ‚ñ≥ABC ‚Üí AH/b = b/c ‚Üí b¬≤ = c¬∑AH. ‚ñ≥BCH ~ ‚ñ≥ABC ‚Üí BH/a = a/c ‚Üí a¬≤ = c¬∑BH. Add: a¬≤+b¬≤ = c(AH+BH) = c¬≤ ‚àé"}
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 1. WORKSHOP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const PHASE_NAMES=["Understand","Plan","Execute","Look Back"];
const PHASE_COLORS=["var(--phase1)","var(--phase2)","var(--phase3)","var(--phase4)"];
let wsState={prob:0,phase:0};

function initWorkshop(){
  const tabs=document.getElementById('ws-tabs');
  PROBLEMS.forEach((p,i)=>{
    const b=document.createElement('button');
    b.className='btn sm'+(i===0?' active':'');
    b.textContent=p.title;
    b.onclick=()=>{wsState.prob=i;wsState.phase=0;
      tabs.querySelectorAll('.btn').forEach((x,j)=>x.classList.toggle('active',j===i));
      renderWorkshop();};
    tabs.appendChild(b);
  });
  renderWorkshop();
}

function renderWorkshop(){
  const p=PROBLEMS[wsState.prob],ph=p.phases[wsState.phase];
  const body=document.getElementById('ws-body');
  let html=`<div class="fade-in">`;
  html+=`<div class="box"><span class="tag">${p.domain}</span><p style="margin-top:8px">${p.statement}</p></div>`;
  // Phase bar
  html+=`<div class="phase-bar">`;
  for(let i=0;i<4;i++) html+=`<div class="phase-pip ${i<wsState.phase?'done':i===wsState.phase?'current':''}"></div>`;
  html+=`</div>`;
  html+=`<h3 style="color:${PHASE_COLORS[wsState.phase]}">Phase ${wsState.phase+1}: ${PHASE_NAMES[wsState.phase]}</h3>`;
  // Questions
  ph.questions.forEach(q=>html+=`<p class="dim" style="margin:6px 0;font-family:var(--font-u);font-size:15px">‚Üí ${q}</p>`);
  // Writing area
  html+=`<textarea rows="3" placeholder="Write your thinking here before revealing hints..." style="margin:12px 0"></textarea>`;
  // Hints
  ph.hints.forEach((h,i)=>{
    html+=`<button class="btn sm" onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='block'?'none':'block'">üí° Hint ${i+1}</button>`;
    html+=`<div style="display:none;padding:12px;margin:4px 0 8px;background:var(--bg);border-radius:8px;color:var(--dim);font-size:15px">${h}</div>`;
  });
  // Nav
  html+=`<div class="btn-row" style="margin-top:16px">`;
  if(wsState.phase>0) html+=`<button class="btn sm" onclick="wsState.phase--;renderWorkshop()">‚Üê Back</button>`;
  if(wsState.phase<3) html+=`<button class="btn sm" onclick="wsState.phase++;renderWorkshop()">Next Phase ‚Üí</button>`;
  else html+=`<button class="btn sm" onclick="wsState.prob=(wsState.prob+1)%PROBLEMS.length;wsState.phase=0;document.querySelectorAll('#ws-tabs .btn').forEach((x,j)=>x.classList.toggle('active',j===wsState.prob));renderWorkshop()">Next Problem ‚Üí</button>`;
  html+=`</div></div>`;
  body.innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 2. HEURISTIC TOOLKIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function initToolkit(){
  const grid=document.getElementById('tk-grid');
  HEURISTICS.forEach((h,i)=>{
    const d=document.createElement('div');
    d.className='btn';d.style.cssText='flex-direction:column;padding:16px;text-align:center;justify-content:center';
    d.innerHTML=`<span style="font-size:1.6rem">${h.icon}</span><span style="font-family:var(--font-u);font-size:13px">${h.name}</span>`;
    d.onclick=()=>showHeuristic(i);
    grid.appendChild(d);
  });
}

function showHeuristic(i){
  const h=HEURISTICS[i];
  document.querySelectorAll('#tk-grid .btn').forEach((x,j)=>x.classList.toggle('active',j===i));
  const ws=document.getElementById('tk-workspace');
  let html=`<div class="box fade-in"><h3>${h.icon} ${h.name}</h3><p>${h.desc}</p>`;
  html+=`<p style="margin-top:12px;color:var(--dim);font-size:15px">${h.detail}</p>`;
  // Action area
  if(h.action==='canvas'){
    html+=`<div style="margin-top:16px"><canvas id="tk-canvas" class="draw-canvas" width="600" height="300"></canvas>`;
    html+=`<div class="btn-row"><button class="btn sm" onclick="clearTkCanvas()">Clear</button></div></div>`;
  } else {
    html+=`<div class="coach" style="margin-top:16px"><p><strong>Try it now:</strong> ${h.prompt}</p></div>`;
    html+=`<textarea rows="3" placeholder="Apply this heuristic to your current problem..."></textarea>`;
  }
  html+=`</div>`;
  ws.innerHTML=html;
  if(h.action==='canvas') initDrawCanvas('tk-canvas');
}

function clearTkCanvas(){
  const c=document.getElementById('tk-canvas');
  if(c) c.getContext('2d').clearRect(0,0,c.width,c.height);
}

function initDrawCanvas(id){
  const c=document.getElementById(id);if(!c)return;
  const ctx=c.getContext('2d');
  // Scale for retina
  const rect=c.getBoundingClientRect();
  c.width=rect.width*2;c.height=rect.height*2;
  c.style.width=rect.width+'px';c.style.height=rect.height+'px';
  ctx.scale(2,2);
  ctx.strokeStyle=PHASE_COLORS[0];ctx.lineWidth=2;ctx.lineCap='round';
  let drawing=false,lx,ly;
  const getPos=(e)=>{
    const r=c.getBoundingClientRect();
    const t=e.touches?e.touches[0]:e;
    return[t.clientX-r.left,t.clientY-r.top];
  };
  c.onpointerdown=(e)=>{drawing=true;[lx,ly]=getPos(e);e.preventDefault();};
  c.onpointermove=(e)=>{if(!drawing)return;const[x,y]=getPos(e);ctx.beginPath();ctx.moveTo(lx,ly);ctx.lineTo(x,y);ctx.stroke();lx=x;ly=y;e.preventDefault();};
  c.onpointerup=c.onpointerleave=()=>{drawing=false;};
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 3. QUESTIONING COACH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let coachState={prob:0,phase:0,qIdx:0};

function initCoach(){
  const tabs=document.getElementById('coach-tabs');
  PROBLEMS.forEach((p,i)=>{
    const b=document.createElement('button');
    b.className='btn sm'+(i===0?' active':'');
    b.textContent=p.title;
    b.onclick=()=>{coachState={prob:i,phase:0,qIdx:0};
      tabs.querySelectorAll('.btn').forEach((x,j)=>x.classList.toggle('active',j===i));
      renderCoach();};
    tabs.appendChild(b);
  });
  renderCoach();
}

function renderCoach(){
  const p=PROBLEMS[coachState.prob];
  const ph=p.phases[coachState.phase];
  const body=document.getElementById('coach-body');
  let html=`<div class="fade-in">`;
  html+=`<div class="box"><span class="tag">${p.domain}</span><p style="margin-top:8px">${p.statement}</p></div>`;
  html+=`<div class="phase-bar">`;
  for(let i=0;i<4;i++) html+=`<div class="phase-pip ${i<coachState.phase?'done':i===coachState.phase?'current':''}"></div>`;
  html+=`</div>`;
  html+=`<h3 style="color:${PHASE_COLORS[coachState.phase]}">Phase ${coachState.phase+1}: ${PHASE_NAMES[coachState.phase]}</h3>`;
  // Show coach questions up to current
  const qs=ph.coachQs;
  for(let i=0;i<=Math.min(coachState.qIdx,qs.length-1);i++){
    html+=`<div class="coach"><p><strong>P√≥lya asks:</strong> ${qs[i]}</p></div>`;
    if(i<coachState.qIdx || i===qs.length-1){
      // Show textarea for answered
      html+=`<textarea rows="2" placeholder="Your response..." style="margin:4px 0 12px"></textarea>`;
    }
  }
  // Controls
  html+=`<div class="btn-row">`;
  if(coachState.qIdx<qs.length-1){
    html+=`<button class="btn sm" onclick="coachState.qIdx++;renderCoach()">I've answered ‚Üí Next question</button>`;
  }
  if(coachState.qIdx>=qs.length-1 && coachState.phase<3){
    html+=`<button class="btn sm" onclick="coachState.phase++;coachState.qIdx=0;renderCoach()">Next Phase ‚Üí</button>`;
  }
  if(coachState.phase>0){
    html+=`<button class="btn sm" onclick="coachState.phase--;coachState.qIdx=0;renderCoach()">‚Üê Back</button>`;
  }
  html+=`</div></div>`;
  body.innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 4. ANALOGY FINDER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let anState={idx:0,selected:null,matched:[]};

function initAnalogy(){
  const tabs=document.getElementById('an-tabs');
  ANALOGIES.forEach((a,i)=>{
    const b=document.createElement('button');
    b.className='btn sm'+(i===0?' active':'');
    b.textContent=a.title;
    b.onclick=()=>{anState={idx:i,selected:null,matched:[]};
      tabs.querySelectorAll('.btn').forEach((x,j)=>x.classList.toggle('active',j===i));
      renderAnalogy();};
    tabs.appendChild(b);
  });
  renderAnalogy();
}

function renderAnalogy(){
  const a=ANALOGIES[anState.idx];
  const body=document.getElementById('an-body');
  let html=`<div class="fade-in"><div class="grid-2">`;
  // Solved side
  html+=`<div class="analogy-card"><h4>‚úì Solved: ${a.solved.name}</h4>`;
  a.solved.steps.forEach((s,i)=>{
    const isMatched=anState.matched.some(m=>m[0]===i);
    html+=`<div class="map-item ${isMatched?'matched':anState.selected&&anState.selected[0]==='L'&&anState.selected[1]===i?'selected':''}" 
      onclick="anSelectLeft(${i})" style="margin:4px 0;display:block">${s}</div>`;
  });
  html+=`</div>`;
  // Unsolved side
  html+=`<div class="analogy-card"><h4>? Unsolved: ${a.unsolved.name}</h4>`;
  a.unsolved.steps.forEach((s,i)=>{
    const isMatched=anState.matched.some(m=>m[1]===i);
    html+=`<div class="map-item ${isMatched?'matched':anState.selected&&anState.selected[0]==='R'&&anState.selected[1]===i?'selected':''}" 
      onclick="anSelectRight(${i})" style="margin:4px 0;display:block">${s}</div>`;
  });
  html+=`</div></div>`;
  // Mappings display
  if(anState.matched.length>0){
    html+=`<div class="box" style="margin-top:12px"><p class="mono dim">Mappings found: ${anState.matched.length}/${a.mappings.length}</p>`;
    anState.matched.forEach(m=>{
      html+=`<div class="mapping-line"><span class="map-item matched">${a.solved.steps[m[0]]}</span><span class="map-arrow">‚Üî</span><span class="map-item matched">${a.unsolved.steps[m[1]]}</span></div>`;
    });
    html+=`</div>`;
  }
  if(anState.matched.length===a.mappings.length){
    html+=`<div class="coach"><p><strong>Insight:</strong> ${a.insight}</p></div>`;
  }
  html+=`<div class="btn-row"><button class="btn sm" onclick="anState.matched=[];anState.selected=null;renderAnalogy()">Reset</button>`;
  html+=`<button class="btn sm" onclick="anReveal()">Reveal All</button></div>`;
  html+=`</div>`;
  body.innerHTML=html;
}

function anSelectLeft(i){
  if(anState.matched.some(m=>m[0]===i))return;
  if(anState.selected&&anState.selected[0]==='R'){
    // Check if this is a valid mapping
    const a=ANALOGIES[anState.idx];
    const ri=anState.selected[1];
    if(a.mappings.some(m=>m[0]===a.solved.steps[i]&&m[1]===a.unsolved.steps[ri])||
       (a.mappings[i]&&i===ri)){
      anState.matched.push([i,ri]);
      anState.selected=null;
    } else {
      // Accept any left-right pair (user mapping)
      anState.matched.push([i,ri]);
      anState.selected=null;
    }
  } else {
    anState.selected=['L',i];
  }
  renderAnalogy();
}

function anSelectRight(i){
  if(anState.matched.some(m=>m[1]===i))return;
  if(anState.selected&&anState.selected[0]==='L'){
    const li=anState.selected[1];
    anState.matched.push([li,i]);
    anState.selected=null;
  } else {
    anState.selected=['R',i];
  }
  renderAnalogy();
}

function anReveal(){
  const a=ANALOGIES[anState.idx];
  anState.matched=a.mappings.map((_,i)=>[i,i]);
  anState.selected=null;
  renderAnalogy();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 5. SPECIALIZATION / GENERALIZATION LAB
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let sgState={idx:0,level:0};

function initSpecGen(){
  const tabs=document.getElementById('sg-tabs');
  SPECGEN_PROBLEMS.forEach((p,i)=>{
    const b=document.createElement('button');
    b.className='btn sm'+(i===0?' active':'');
    b.textContent=p.title;
    b.onclick=()=>{sgState={idx:i,level:0};
      tabs.querySelectorAll('.btn').forEach((x,j)=>x.classList.toggle('active',j===i));
      renderSpecGen();};
    tabs.appendChild(b);
  });
  renderSpecGen();
}

function renderSpecGen(){
  const p=SPECGEN_PROBLEMS[sgState.idx];
  const body=document.getElementById('sg-body');
  const maxLevel=p.cases.length-1;
  let html=`<div class="fade-in">`;
  html+=`<div class="slider-wrap">`;
  html+=`<input type="range" min="0" max="${maxLevel}" value="${sgState.level}" oninput="sgState.level=+this.value;renderSpecGen()">`;
  html+=`<div class="slider-labels"><span>Most Specific</span><span>Most General</span></div>`;
  html+=`</div>`;
  // Display all cases up to current level
  html+=`<div class="spec-display">`;
  for(let i=0;i<=sgState.level;i++){
    const c=p.cases[i];
    const isCurrent=i===sgState.level;
    html+=`<div style="opacity:${isCurrent?1:.5};${isCurrent?'color:var(--accent)':''}">`;
    html+=`<strong>${c.n}:</strong> ${c.val} ‚Üí <span style="color:var(--accent2)">${c.formula}</span>`;
    html+=`</div>`;
  }
  html+=`</div>`;
  // Insight when fully general
  if(sgState.level===maxLevel){
    html+=`<div class="coach"><p><strong>Pattern revealed:</strong> ${p.insight}</p></div>`;
  }
  html+=`</div>`;
  body.innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 6. LOOK BACK REFLECTOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let lbState={idx:0};

function initLookBack(){
  const tabs=document.getElementById('lb-tabs');
  LOOKBACK_PROBLEMS.forEach((p,i)=>{
    const b=document.createElement('button');
    b.className='btn sm'+(i===0?' active':'');
    b.textContent=p.title;
    b.onclick=()=>{lbState.idx=i;
      tabs.querySelectorAll('.btn').forEach((x,j)=>x.classList.toggle('active',j===i));
      renderLookBack();};
    tabs.appendChild(b);
  });
  renderLookBack();
}

function renderLookBack(){
  const p=LOOKBACK_PROBLEMS[lbState.idx];
  const body=document.getElementById('lb-body');
  let html=`<div class="fade-in">`;
  html+=`<div class="coach"><p><strong>P√≥lya says:</strong> "By looking back at the completed solution, by reconsidering and reexamining the result and the path that led to it, they could consolidate their knowledge and develop their ability to solve problems."</p></div>`;
  p.questions.forEach((q,i)=>{
    html+=`<div class="reflect-q" onclick="this.classList.toggle('open')">`;
    html+=`<p style="font-family:var(--font-u);font-size:15px;cursor:pointer">üîç ${q.q}</p>`;
    html+=`<div class="answer">${q.a}</div>`;
    html+=`</div>`;
  });
  html+=`</div>`;
  body.innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 7. AUXILIARY ELEMENTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let auxState={idx:0,hintLevel:0};

function initAuxiliary(){
  const tabs=document.getElementById('aux-tabs');
  AUX_PROBLEMS.forEach((p,i)=>{
    const b=document.createElement('button');
    b.className='btn sm'+(i===0?' active':'');
    b.textContent=p.title;
    b.onclick=()=>{auxState={idx:i,hintLevel:0};
      tabs.querySelectorAll('.btn').forEach((x,j)=>x.classList.toggle('active',j===i));
      renderAuxiliary();};
    tabs.appendChild(b);
  });
  renderAuxiliary();
}

function renderAuxiliary(){
  const p=AUX_PROBLEMS[auxState.idx];
  const body=document.getElementById('aux-body');
  let html=`<div class="fade-in">`;
  html+=`<p class="dim" style="margin-bottom:12px">${p.desc}</p>`;
  html+=`<p style="font-family:var(--font-u);font-size:14px;color:var(--accent);margin-bottom:8px">Draw your auxiliary line on the canvas:</p>`;
  html+=`<canvas id="aux-canvas" class="draw-canvas" width="600" height="360" style="height:360px"></canvas>`;
  // Hints
  html+=`<div class="btn-row">`;
  html+=`<button class="btn sm" onclick="clearAuxCanvas()">Clear Drawing</button>`;
  html+=`<button class="btn sm" onclick="redrawAuxBase()">Redraw Figure</button>`;
  p.hints.forEach((_,i)=>{
    html+=`<button class="btn sm" onclick="showAuxHint(${i})">üí° Hint ${i+1}</button>`;
  });
  html+=`<button class="btn sm" onclick="document.getElementById('aux-solution').style.display='block'">Show Solution</button>`;
  html+=`</div>`;
  // Hint display
  html+=`<div id="aux-hints"></div>`;
  html+=`<div id="aux-solution" style="display:none" class="coach"><p><strong>Solution:</strong> ${p.solution}</p></div>`;
  html+=`</div>`;
  body.innerHTML=html;
  // Init canvas
  setTimeout(()=>{
    const c=document.getElementById('aux-canvas');
    if(!c)return;
    const rect=c.getBoundingClientRect();
    c.width=rect.width*2;c.height=rect.height*2;
    c.style.width=rect.width+'px';c.style.height=rect.height+'px';
    const ctx=c.getContext('2d');
    ctx.scale(2,2);
    // Draw base figure
    p.canvasSetup(ctx,rect.width,rect.height);
    // Enable drawing
    ctx.strokeStyle='#d4a056';ctx.lineWidth=2;ctx.lineCap='round';
    let drawing=false,lx,ly;
    const getPos=(e)=>{const r=c.getBoundingClientRect();const t=e.touches?e.touches[0]:e;return[t.clientX-r.left,t.clientY-r.top];};
    c.onpointerdown=(e)=>{drawing=true;[lx,ly]=getPos(e);e.preventDefault();};
    c.onpointermove=(e)=>{if(!drawing)return;const[x,y]=getPos(e);ctx.beginPath();ctx.moveTo(lx,ly);ctx.lineTo(x,y);ctx.stroke();lx=x;ly=y;e.preventDefault();};
    c.onpointerup=c.onpointerleave=()=>{drawing=false;};
  },50);
}

function clearAuxCanvas(){
  const c=document.getElementById('aux-canvas');if(!c)return;
  const ctx=c.getContext('2d');
  ctx.clearRect(0,0,c.width,c.height);
  redrawAuxBase();
}

function redrawAuxBase(){
  const c=document.getElementById('aux-canvas');if(!c)return;
  const ctx=c.getContext('2d');
  const rect=c.getBoundingClientRect();
  ctx.clearRect(0,0,rect.width,rect.height);
  AUX_PROBLEMS[auxState.idx].canvasSetup(ctx,rect.width,rect.height);
  ctx.strokeStyle='#d4a056';ctx.lineWidth=2;ctx.lineCap='round';
}

function showAuxHint(i){
  const hints=AUX_PROBLEMS[auxState.idx].hints;
  let html='';
  for(let j=0;j<=i;j++){
    html+=`<div class="coach" style="border-color:var(--phase2)"><p>${hints[j]}</p></div>`;
  }
  document.getElementById('aux-hints').innerHTML=html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.addEventListener('DOMContentLoaded',()=>{
  initWorkshop();
  initToolkit();
  initCoach();
  initAnalogy();
  initSpecGen();
  initLookBack();
  initAuxiliary();

  // Highlight active nav on scroll
  const sections=document.querySelectorAll('section[id]');
  const navLinks=document.querySelectorAll('nav a:not(.brand)');
  window.addEventListener('scroll',()=>{
    let current='';
    sections.forEach(s=>{
      if(window.scrollY>=s.offsetTop-100) current=s.id;
    });
    navLinks.forEach(a=>a.classList.toggle('active',a.getAttribute('href')==='#'+current));
  });
});
</script>
</body>
</html>
